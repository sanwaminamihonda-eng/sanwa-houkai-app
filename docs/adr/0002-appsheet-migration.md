# ADR-0002: AppSheetからの移行

## Status

**Accepted**

## Context

現在AppSheet + Google Sheetsで運用中の訪問介護記録アプリを、Firebase Data Connect + React Native/Next.jsアーキテクチャへ移行する。

### 現行システム

| 項目 | 値 |
|------|-----|
| プラットフォーム | AppSheet |
| データソース | Google Sheets |
| ユーザー数 | 約30人 |
| 記録数 | 約2万レコード |
| 運用期間 | 稼働中 |

### AppSheetの課題

| 課題 | 影響 | 新システムでの解決策 |
|------|------|---------------------|
| 柔軟なUIが作れない | ユーザー体験の制限 | React Native/Next.jsでカスタムUI |
| 機能追加のたびに複雑化 | 開発・保守コスト増大 | コードベースで明確な構造 |
| オフライン起因のバージョン不一致 | データ不整合、エラー | オフライン非対応で根本解決（ADR-0001） |
| PDF生成が遅い | 業務効率低下 | サーバーサイドPDF生成 |
| 柔軟なスケジュール機能が作れない | Googleカレンダー依存 | カスタムスケジュールUI実装 |

## Decision

### 移行方針

1. **段階的移行**: MVPで基本機能を実装し、並行運用後に完全移行
2. **機能継承**: AppSheetの機能的な考え方は引き継ぐが、制限は解消
3. **データ移行**: MVP段階はseedデータ、本番移行は別途計画

### 継承する設計思想

| 思想 | 実装方針 |
|------|---------|
| マルチデバイス対応 | React Native（モバイル）+ Next.js（Web）でレスポンシブ |
| シンプルなUIUX | 最小限のステップで操作完了、直感的なナビゲーション |
| 現場での即時入力 | モバイルファースト、タッチ操作最適化 |

### 新システムで実現する改善

| 改善項目 | 具体的実装 |
|---------|-----------|
| 柔軟なUI | デバイス別に最適化されたコンポーネント |
| 高速PDF生成 | Cloud Functions + サーバーサイドレンダリング |
| 拡張可能なスケジュール | ドラッグ&ドロップ、繰り返しパターン、職員別ビュー |
| AI機能 | Vertex AI Geminiによる記録要約、入力補助 |

## Consequences

### メリット

- AppSheetの制限から解放
- カスタム機能の自由な実装
- AI機能の本格統合
- 長期的な保守性向上

### デメリット

- 初期開発コスト
- 並行運用期間の管理負荷
- ユーザーの再教育コスト

### リスク軽減

- MVPで早期にユーザーフィードバック取得
- 既存UIに近いデザインで学習コスト最小化
- 十分な並行運用期間の確保

## AI駆動開発への指針

### 判断基準

```
IF AppSheetで実現していた機能 THEN 同等以上の機能を実装
IF AppSheetで実現できなかった機能 THEN 優先的に実装検討
IF 新規機能の提案 THEN requirements.mdの優先度に従う
```

### 実装時の参照順序

1. このADRで課題と解決策を確認
2. requirements.mdで機能要件を確認
3. data-model.mdでデータ構造を確認
4. architecture.mdで技術制約を確認
